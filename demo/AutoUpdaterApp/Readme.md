
---

### 功能说明

1. **版本检查功能**:
   - 当点击“检查更新”按钮时，程序会从远程URL下载一个JSON文件。这个JSON文件包含了最新版本的信息，如版本号、下载URL和文件的SHA256哈希。
   - 下载的版本信息与当前运行的应用版本进行比较，以确定是否需要更新。

2. **更新功能**:
   - 如果远程版本比当前版本新，程序会开始下载更新。
   - 下载的文件首先与预期的SHA256哈希进行比较，以确保文件的完整性。
   - 如果文件完整，应用程序会从ZIP文件中提取内容到当前的应用目录。
   - 提取完成后，启动“setup.exe”来完成更新。

3. **异常处理和反馈**:
   - 在检查、下载或更新过程中发生任何错误时，都会给用户提供明确的错误信息。
   - 如果应用程序已经是最新版本，用户会收到一个确认信息。

4. **进度显示**:
   - 在更新过程中，显示一个进度条窗口，实时显示下载的进度。
   - 进度显示包括百分比和文字说明。

---

### 结构说明

1. **`MainWindow` 类**:
   - **`OnCheckForUpdatesClick` 方法**: 当点击“检查更新”按钮时触发的事件处理器。首先检查是否有新的版本，如果有，就开始下载和更新过程。
   
   - **`CheckForUpdatesAsync` 方法**: 从远程URL异步下载版本信息。
   
   - **`ApplyUpdateAsync` 方法**: 下载、验证、解压和启动更新程序的主要方法。
   
   - **`ValidateSHA256` 方法**: 使用SHA256哈希检查下载文件的完整性。
   
   - **`UpdateInfo` 类**: 内部类，用于解析和存储从远程URL下载的版本信息。

2. **`UpdateProgressWindow` 类** (在先前的答案中提供):
   - 这是一个窗口类，用于在下载更新时显示进度条。
   - 它提供了两个方法来更新进度条的值和显示的文字。

3. **`App` 类**:
   - 这是WPF应用程序的入口点。在启动时，它会首先检查更新，如果有新版本，则自动开始下载和更新。然后显示主窗口。

4. **网络通信**:
   - 所有的网络通信都是通过`HttpClient`实现的，包括下载版本信息和下载更新包。

5. **异常处理**:
   - 代码中有多处异常处理机制，确保应用程序在遇到问题时能给用户明确的反馈。

---

### 网络文件说明

1. **`update-info.json`**:

   - **来源**: 远程服务器上的文件，具体位置为 `https://raw.githubusercontent.com/maskonface/updateTestServer/main/AutoUpdaterRelease/update-info.json`。
   
   - **目的**: 提供软件的最新版本信息。
   
   - **内容**:
     - **`version`**: 字符串格式，表示软件的最新版本。当前最新版本为 "1.1.0".
     - **`sha256`**: 字符串格式，代表更新文件的SHA256哈希值。用于下载后验证文件的完整性。当前哈希值为 "a8df46655fe6556ce43901cbe0b4566d8193ede4c9b823c32456b5f7337b2784".
     - **`url`**: 字符串格式，提供更新文件的下载链接。当前下载链接为 "https://github.com/maskonface/updateTestServer/raw/main/AutoUpdaterRelease/GameAssistant_v1.08.zip".
   
   - **示例**:
     ```json
     {
         "version": "1.1.0",
         "sha256": "a8df46655fe6556ce43901cbe0b4566d8193ede4c9b823c32456b5f7337b2784",
         "url": "https://github.com/maskonface/updateTestServer/raw/main/AutoUpdaterRelease/GameAssistant_v1.08.zip"
     }
     ```

2. **更新文件 (例如: `GameAssistant_v1.08.zip`)**:

   - **来源**: 由`update-info.json`中的`url`字段指定的远程服务器。
   
   - **目的**: 包含新版本的所有文件，供应用程序下载并更新。
   
   - **内容**: 
     - 压缩格式为ZIP，当下载并验证完整性后，会被解压到应用程序的目录。
     - 应该包含所有新版本所需的文件，以及一个`setup.exe`文件来处理安装或更新过程。

---
